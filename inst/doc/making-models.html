<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2017-04-18" />

<title>Creating new ss3sim operating and estimation model setups</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Creating new ss3sim operating and estimation model setups</h1>
<h4 class="date"><em>2017-04-18</em></h4>


<div id="TOC">
<ul>
<li><a href="#om-setup"><span class="toc-section-number">1</span> Setting up a new operating model</a><ul>
<li><a href="#forecast-file-modifications"><span class="toc-section-number">1.1</span> Forecast file modifications</a></li>
<li><a href="#starter-file-modifications"><span class="toc-section-number">1.2</span> Starter file modifications</a></li>
<li><a href="#control-file-modifications"><span class="toc-section-number">1.3</span> Control file modifications</a></li>
<li><a href="#data-file-modifications"><span class="toc-section-number">1.4</span> Data file modifications</a></li>
</ul></li>
<li><a href="#em-setup"><span class="toc-section-number">2</span> Setting up a new estimation model</a><ul>
<li><a href="#starter-file-modifications-1"><span class="toc-section-number">2.1</span> Starter file modifications</a></li>
<li><a href="#control-file-modifications-1"><span class="toc-section-number">2.2</span> Control file modifications</a></li>
<li><a href="#data-file-modifications-1"><span class="toc-section-number">2.3</span> Data file modifications</a></li>
<li><a href="#testing-the-new-estimation-model"><span class="toc-section-number">2.4</span> Testing the new estimation model</a></li>
</ul></li>
</ul>
</div>

<p>In some cases you may wish to adapt your own SS3 model to work with the ss3sim package. This is possible but may be difficult because the functions in ss3sim were developed to work with the existing model setups and a model with a different structure may cause errors in these functions. This stems from the high flexibility of SS3, allowing for more complex model setups than those used while developing ss3sim.</p>
<p>For instance, <code>sample_index()</code> does not currently have the capability to handle more than one season. Given the many options available in SS3, it is extremely difficult to write auxiliary functions that will interact reliably with all combinations of these options. For this reason, we recommend that users strongly consider trying to <a href="modifying-models.html">modify an existing model rather than creating a new one</a>. It is likely that the ss3sim functions will need to be modified in some way in the process, so the user should be familiar with both SS3 and R.</p>
<p>The main purpose of the OM (operating model) is to generate data files that can be read into the EM (estimation model). Thus the user needs to setup the <code>.dat</code> files in the OM such that they conform to the structure needed by the EM. Two key examples are with survey and age/length composition data. For the indices of abundance (CPUE and scientific survey) the OM <code>.dat</code> file will determine which years are available to the sampling function <code>sample_index()</code>, so if a year is desired in the EM it needs to be in the OM. In practice it may be easiest to just include all years in the OM if surveys will be dynamic (i.e.Â changing years between scenarios), or if it will be fixed for all scenarios to set it to match the EM exactly.</p>
<p>Similarly, with age/length compositions, the OM <code>.dat</code> file will determine which years and bins are available to the sampling functions <code>sample_agecomp()</code> and <code>sample_lcomp()</code>. If dynamic binning is to be used, the user should setup the <code>.dat</code> file so that all desired combinations of bins are possible (see the <a href="Introduction.html#change-data">section in the Introduction vignette on dynamic binning</a> for more details). Specifically, the user must specify small enough OM <code>.ctl</code> bins (no smaller than the population bin specified in the appropriate section in the OM <code>.dat</code> file) so that they can easily be re-binned. Alternatively, if composition data is not to be explored in the simulation then the user can just set the OM <code>.dat</code> file to match the desired input for the EM <code>.dat</code>.</p>
<p>For those users who choose to create a new ss3sim model setup, we outline the steps to take an existing SS3 model and modify it to work with the ss3sim package. First, we cover setting up an operating model and then we cover <a href="#em-setup">setting up an estimation model</a>.</p>
<div id="om-setup" class="section level1">
<h1><span class="header-section-number">1</span> Setting up a new operating model</h1>
<p>The first step is to run the assessment model to make sure the model runs and estimates parameters as desired. The <code>.par</code> file generated will be used in the OM. We recommend opening a command window inside your OM and EM folder to help test whether the model still runs at many points along the process. After turning parameter estimation off in the starter file (see below), the model can be checked by running <code>ss3_24o_safe -nohess</code> to make sure the input files are read in properly and the model writes the files. Use the <code>.ss_new</code> files produced as a starting point so that the comments match the instructions below.</p>
<p>You will see an error by ADMB that it cannot find the data file because we have specified a different file in the starter file. You can safely ignore this error.</p>
<div id="forecast-file-modifications" class="section level2">
<h2><span class="header-section-number">1.1</span> Forecast file modifications</h2>
<ul>
<li>If <code># Do West Coast gfish rebuilder output (0/1)</code> is set to 1, set it to 0. Comment out lines below specifying the years of the rebuilder.</li>
</ul>
</div>
<div id="starter-file-modifications" class="section level2">
<h2><span class="header-section-number">1.2</span> Starter file modifications</h2>
<ul>
<li><p>Delete the <code>starter.ss</code> file and rename <code>starter.ss_new</code> to <code>starter.ss</code>. Modify this new file.</p></li>
<li><p>Turn off parameter estimation by changing <code># Turn off estimation for parameters entering after this phase</code> to <code>0</code>.</p></li>
<li><p>Use the <code>.par</code> file to initialize model parameters. To do so change <code># 0=use init values in Starter file</code> to <code>1</code>. Parameter values specified in the <code>.ctl</code> file will now be ignored.</p></li>
<li><p>Generate detailed report files (containing age-structure information) by setting <code># detailed age-structured reports in REPORT.SSO</code> to <code>1</code>.</p></li>
<li><p>Generate data by setting <code># Number of datafiles to produce</code> to <code>3</code>. If <code>X=1</code> it only generates the original data If <code>X=2</code> it generates the original data and the expected value data (based on model specification) If <code>X&gt;=3</code> it generates all the above and <code>X-2</code> bootstrapped data sets</p></li>
<li><p>Turn off parameter jittering by setting <code># jitter initial parm value by this fraction</code> to <code>0</code>. Jitter is used, among other things, to test for convergence to the same solution when starting from alternative initial values; however, the OM is used here as the truth, so jittering is not needed.</p></li>
<li><p>Turn off retrospective analyses by setting <code># retrospective year relative to end year</code> to <code>0</code>. To analyze the data for retrospective patterns, use the R case file.</p></li>
<li><p>Specify how catch is reported by setting <code># F_report_units</code> to <code>1</code> if catch is reported in biomass or <code>2</code> if catch is reported in numbers. Additionally, comment out the next line, <code>#_min and max age over which average F will be calculated</code>, by removing all characters prior to the hash symbol.</p></li>
<li><p>Implement catches using instantaneous fishing mortality by changing <code># F_report_basis</code> to <code>0</code>.</p></li>
</ul>
</div>
<div id="control-file-modifications" class="section level2">
<h2><span class="header-section-number">1.3</span> Control file modifications</h2>
<ol style="list-style-type: decimal">
<li><p>Delete the <code>&lt;modelname&gt;.ctl</code> file and rename <code>control.ss_new</code> to <code>om.ctl</code>. Modify this new file.</p></li>
<li><p>Specify all environmental deviates on biological parameters to be unconstrained by bounds by setting <code>#_env/block/dev_adjust_method</code> to <code>1</code>. If the method is set to <code>2</code>, parameters adjusted using environmental covariate inputs will be adjusted using a logistic transformation to ensure that the adjusted parameter will stay within the bounds of the base parameter. If it exists and is not already commented out, comment out the second line entitled <code>#_env/block/dev_adjust_method</code> underneath the section which specifies selectivity parameters. If time-varying selectivity parameters are added using the <code>change_tv()</code> function, this line will be modified by the same function.</p></li>
<li><p>Turn on recruitment deviations by specifying <code>#do_recdev</code> to <code>1</code>. Using the next two lines, specify the use of recruitment deviations to begin and end with the start and end years of the model.</p></li>
<li><p>Turn on additional advanced options for the recruitment deviations by specifying <code># (0/1) to read 13 advanced options</code> to <code>1</code>.</p></li>
<li><p>Set <code>#_recdev_early_start</code> to <code>0</code> so that the model will use the <code># first year of main recr_devs</code>.</p></li>
<li><p>Set <code>#_lambda for Fcast_rec_like occurring before endyr+1</code> to <code>1</code>. This lambda is for the log likelihood of the forecast recruitment deviations that occur before the first year of forecasting. Values larger than one accommodate noisy data at the end of the time series.</p></li>
<li><p>Recruitment is log-normally distributed in SS. If inputting a normally distributed recruitment deviations specify <code>#_max_bias_adj_in_MPD</code> to <code>-1</code> so that SS performs the bias correction for you. If inputting bias corrected normal recruitment deviation, specify it at <code>0</code>. Either method will lead to the same end result.</p></li>
<li><p>Use any negative value in line <code># F ballpark year</code>, to disable the use of a ballpark year to determine fishing mortality levels.</p></li>
<li><p>Specify <code># F_Method</code> to <code>2</code>, which facilitates the use of a vector of instantaneous fishing mortality levels. The max harvest rate in the subsequent line will depend upon the fishing mortality levels in your simulation. Following the max harvest rate, specify a line with three value separated by spaces. The first value is the overall start F value, followed by the phase. The last value is the number of inputs. Set the number of inputs to <code>1</code>, because the actual fishing mortality trajectory will be specified in the <code>.dat</code> file. Next, specify a single line with six values, separated by spaces, where the values correspond to fleet number, start year, season, fishing mortality level, the standard error of the fishing mortality level, and a negative phase value. E.g <code>1 2000 1 0 0.01 -1</code></p></li>
<li><p>Set <code>#_Variance_adjustments_to_input_values</code> to <code>0</code>. Comment out any lines underneath referring to variance adjustments.</p></li>
<li><p>Set <code># number of changes to make to default Lambdas</code> to <code>0</code>. Comment out any lines with default lambda changes below.</p></li>
<li><p>If needed, change the specification of the <code>.ctl</code> using the functions available in the ss3sim package. E.g <code>change_growth</code>, <code>change_sel</code>.</p></li>
</ol>
</div>
<div id="data-file-modifications" class="section level2">
<h2><span class="header-section-number">1.4</span> Data file modifications</h2>
<ol style="list-style-type: decimal">
<li><p>Delete the <code>&lt;modelname&gt;.dat</code> file and rename <code>data.ss_new</code> to <code>om.dat</code>. Modify this new file.</p></li>
<li><p>Specify the start and end year for the simulation by modifying <code>#_styr</code> and <code>#_endyr</code>. Years can be specified as a number line (i.e.Â <code>1</code>, <code>2</code>, <code>3</code>, â¦) or as actual years (i.e.Â <code>1999</code>, <code>2000</code>, <code>2001</code>, â¦).</p></li>
<li><p>Specify the names for each fleet in an uncommented line after the line <code>#_N_areas</code>. Names must be separated by a <code>%</code> with no spaces. It is these names which you will use in the plain text case files to specify and change characteristics of each fleet throughout the simulation. E.g.Â <code>Fishery%Survey1%Survey2</code></p></li>
<li><p>Specify the number of mean body weight observations across all selected sizes and ages to be specific to measured fish by setting <code>#_N_meanbodywt</code> to <code>0</code>. Subsequently, specify <code>1</code> under <code>#_DF_for_meanbodywt_T-distribution_like</code> - this is the degree of freedom for the Studentâs T distribution used to evaluated the mean body weight deviations in the following line. The degrees of freedom must be specified even if there are zero mean body weight observations.</p></li>
<li><p>Set the length bin method to 1 or 2 in the line labelled <code># length bin method</code>. Using a value of <code>1</code>, the bins refer to the data bins (specified later). Using a value of <code>2</code> instructs SS to generate the bin widths from a user specified minimum and maximum value. In the following three lines, specify the bin width for population size composition data; the minimum size, or the lower edge of the first bin and size at age zero; and the maximum size, or lower edge of the last bin. The length data bins MUST be wider than the population bin, but the boundaries do not have to align.</p></li>
<li><p>Specify <code>#_comp_tail_compression</code> to any negative value to turn off tail compression.</p></li>
<li><p>Specify <code>#_add_to_comp</code> to a very small number E.g <code>1e-005</code>. This specifies the value that will be added to each composition (age and length) data bins.</p></li>
<li><p>Set the length bin range method for the age composition data (used when the conditional age at length data exists) to 1, 2 or 3 in the line <code>#_Lbin_method</code> depending on the data you have or the purpose of the study.</p></li>
</ol>
</div>
</div>
<div id="em-setup" class="section level1">
<h1><span class="header-section-number">2</span> Setting up a new estimation model</h1>
<p>Unlike the OM, the EM needs to be a valid SS3 model setup and run to achieve maximum likelihood estimates (and possibly standard errors). Thus the OM needs to be adapted to create a new EM.</p>
<div id="starter-file-modifications-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Starter file modifications</h2>
<ol style="list-style-type: decimal">
<li><p>Change the names of the <code>.dat</code> and <code>.ctl</code> files to your chosen naming scheme.</p></li>
<li><p>Specify the model to use parameter values found in the <code>.ctl</code> file, by changing <code># 0=use init values in control file; 1=use ss3.par</code> to <code>0</code>.</p></li>
<li><p>Turn on parameter estimation by changing <code># Turn off estimation for parameters entering after this phase</code> to a value larger than the max phase specified in the <code>.ctl</code> file.</p></li>
</ol>
</div>
<div id="control-file-modifications-1" class="section level2">
<h2><span class="header-section-number">2.2</span> Control file modifications</h2>
<ol style="list-style-type: decimal">
<li><p>Set the phases of the parameters to positive or negative value to inform SS to estimate or fix the parameters, respectively. <em>(TODO can we give a few words of guidance about which parameters may want to be estimated by default? -SA)</em></p></li>
<li><p>Set the <code>#_recdev phase</code> to a positive value to estimate yearly recruitment deviations.</p></li>
<li><p>If using bias adjustment set <code>#_recdev_early_phase</code> to a positive value. Estimates for the years and maximum bias adjustment can initially be inputted with approximations or use the bias adjustment function within ss3sim to find appropriate values for the base case EM and input them in the appropriate lines. <em>(TODO can we provide guidance on how this phase should relate to <code>recdev phase</code>?)</em></p></li>
<li><p>Specify <code># F_Method</code> to <code>3</code>, which allows the model to use catches to estimate appropriate fishing mortality levels. The max harvest rate in the subsequent line will depend upon the fishing mortality levels in your simulation. An additional line must be inserted after the maximum harvest rate to specify the number of iterations used in the hybrid method from <code>3</code> to <code>7</code>.</p></li>
<li><p>If it exists and is not already commented out, comment out the second line entitled <code>#_env/block/dev_adjust_method</code> underneath the section which specifies selectivity parameters. If time-varying selectivity parameters are added using the <code>change_tv()</code> function, this line will be modified by the same function.</p></li>
<li><p>Use the functions in the ss3sim package to change the estimation specification in the EM. E.g.Â <code>change_e</code></p></li>
</ol>
</div>
<div id="data-file-modifications-1" class="section level2">
<h2><span class="header-section-number">2.3</span> Data file modifications</h2>
<p>You can delete the <code>.dat</code> file from the EM model setup. The <code>data.ss_new</code> files produced when executing the OM contain the expected values of the OM population dynamics. The data the EM model is fit to needs to be sampled with observation error from these expected values in order to mimic the random sampling process done with real fisheries data. The ss3sim package provides three functions which carry out the random sampling process and generate <code>.dat</code> files to be used in the EM. See the <a href="introduction.html#obs-error">Introduction vignette section</a> for more details.</p>
</div>
<div id="testing-the-new-estimation-model" class="section level2">
<h2><span class="header-section-number">2.4</span> Testing the new estimation model</h2>
<p>After completing the above steps run the model manually for a single iteration. Verify that the data are read in correctly and expected values of the population dynamics are written to the <code>.dat</code> files (and sensical). Verify that the EM loads the data properly and the objective function value (negative log-likelihood) is sensible. If it works correctly, try running deterministic cases on the model (see the <a href="introduction.html#deterministic">Introduction vignette</a>) and further verify that ss3sim functions that modify the EM (e.g., <code>change_e</code>) act correctly on the model setup. The help files for the functions demonstrate how to use the functions to test models. Note that the OM will not be a valid SS3 model in the sense that ADMB cannot run and produce maximum likelihood estimates of parameters; it is intended to only be run for one iteration to generate the population dynamics using values specified in the input files. It is possible that some of the functions will not work perfectly with the new model setups. In this case, it may be necessary to modify the ss3sim functions to be compatible with the new OM and EM.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
